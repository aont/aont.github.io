<html>
<head>
<title>Clipboard</title>
<script>
window.addEventListener('load', (event) => {

  var readClipboardTextarea = document.createElement("textarea");
  readClipboardTextarea.style.width = "100%";

  function rctAutoExpand(shrink=false) {
    if(shrink) {
      readClipboardTextarea.style.height = "";
    }
    var rctHeightSave = readClipboardTextarea.computedStyleMap().get("height").value;
    if(rctHeightSave=="auto") rctHeightSave = 0;
    var rctScrollHeight = readClipboardTextarea.scrollHeight
    if(rctScrollHeight>rctHeightSave) {
      readClipboardTextarea.style.height = (rctScrollHeight+2) + "px";
    }
  }
  readClipboardTextarea.addEventListener("input", (event)=>{
    console.log("input")
    rctAutoExpand();
  })
  document.body.appendChild(readClipboardTextarea);

  document.body.appendChild(document.createElement("br"));

  var button = document.createElement("button");
  button.innerText = "write html";
  document.body.appendChild(button);
  button.addEventListener("click", async (event) => {
    // var div_begin = "<div dir=\"auto\" style=\"font-size: 16px; font-style: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration: none; caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: -apple-system, HelveticaNeue; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); -webkit-text-size-adjust: none;\">";
    var div_begin = "<div>";
    var div_end = "</div>";
    var br = "<br>";
    var text = readClipboardTextarea.value;
    var htmlText = div_begin + text.split("\n").join(br+div_end+div_begin) + div_end;

    var blobHtml = new Blob([htmlText], { type: "text/html" });
    var blobPlain = new Blob([text], { type: "text/plain" });
    var data = [new ClipboardItem({ "text/html": blobHtml, "text/plain": blobPlain})];
    await navigator.clipboard.write(data);
  });
  

});
</script>
</head>
<body></body>
</html>


