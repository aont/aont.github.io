<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Clipboard Processor</title>
</head>
<body>

<button id="process">Format and overwrite clipboard</button>
<div id="log"></div>

<script>
function log(msg){
  const t = new Date().toISOString().replace('T',' ');
  document.getElementById('log').innerHTML += `[${t}] ${msg}<br>\n`;
}

async function processClipboard(){
  try{
    const text = await navigator.clipboard.readText();
    if(!text){log("âš  No text found in the clipboard"); return;}
    log(`ðŸ“¥ Input detected (${text.length} characters)`);

    const htmlText = text.split(/\r?\n/).reduce(function (a, c) {
      if (c === "") {
        c = "<br>";
      }
      return a + "<div>" + c + "</div>";
    }, "");

    console.log(htmlText);
    await navigator.clipboard.write([new ClipboardItem({
      "text/plain": new Blob([text], {type:"text/plain"}),
      "text/html" : new Blob([htmlText], {type:"text/html"})
    })]);
    log("ðŸ“¤ Clipboard write completed");
  }catch(e){ log(`ðŸ’¥ Error: ${e.message}`); }
}

document.getElementById('process').addEventListener('click', processClipboard);
</script>
</body>
</html>